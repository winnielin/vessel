<!--
 =========================================================
 Material Dashboard PRO - v2.1.0
 =========================================================

 Product Page: https://www.creative-tim.com/product/material-dashboard-pro
 Copyright 2019 Creative Tim (https://www.creative-tim.com)

 Coded by Creative Tim

 =========================================================

 The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->

<!DOCTYPE html>
<html lang="en">

<head>
  <title>Vessel Geo Monitoring</title>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <!--     Fonts and icons     -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
  <link rel="icon" type="image/png" sizes="32x32" href="https://insurwave.com/images/favicon-32x32.png">  
  <link rel="icon" type="image/png" sizes="16x16" href="https://insurwave.com/images/favicon-16x16.png">
  <!-- Material Kit CSS -->
  <link href="assets/css/material-dashboard.css?v=2.1.0" rel="stylesheet" />
  
</head>

<body>
  <div class="wrapper ">
    <div class="sidebar" data-color="purple" data-background-color="black">
      <!--
      Tip 1: You can change the color of the sidebar using: data-color="purple | azure | green | orange | danger"

      Tip 2: you can also add an image using data-image tag
  -->
      <div class="logo">
        <a href="https://insurwave.com" class="simple-text logo-mini"> 
          
        </a>
        <a href="https://insurwave.com" class="simple-text logo-normal">
          INSURWAVE
        </a>
      </div>
      <div class="sidebar-wrapper">
        <ul class="nav">
          <li class="nav-item ">
            <a class="nav-link" href="index.html"> <!-- -->
              <i class="material-icons">dashboard</i>
              <p>My Fleet</p>
            </a>
          </li>
            <li class="nav-item active  ">
              <a class="nav-link" href="#0"> <!-- -->
                <i class="material-icons">show_chart</i>
                <p>Fleet Analysis</p>
              </a>
            </li>
            <li class="nav-item ">
                <a class="nav-link" data-toggle="collapse" href="#maersk">
                  <i class="material-icons">image</i>
                  <p> Maersk
                    <b class="caret"></b>
                  </p>
                </a>
                <div class="collapse" id="maersk">
                  <ul class="nav">
                    <li class="nav-item ">
                      <a class="nav-link" href="vessel.html">
                        <span class="sidebar-mini"> K </span>
                        <span class="sidebar-normal"> Maersk Kimi </span>
                      </a>
                    </li>
                    <li class="nav-item ">
                      <a class="nav-link" href="#">
                        <span class="sidebar-mini"> P </span>
                        <span class="sidebar-normal"> Maersk Palermo </span>
                      </a>
                    </li>
                    <li class="nav-item ">
                      <a class="nav-link" href="#">
                        <span class="sidebar-mini"> V </span>
                        <span class="sidebar-normal"> Maersk Vega </span>
                      </a>
                    </li>
                    <li class="nav-item ">
                            <a class="nav-link" href="#">
                              <span class="sidebar-mini"> V </span>
                              <span class="sidebar-normal"> Maersk Ventura </span>
                            </a>
                          </li>
                  </ul>
                </div>
              </li>
              <li class="nav-item ">
                    <a class="nav-link" data-toggle="collapse" href="#NYK">
                      <i class="material-icons">image</i>
                      <p> NYK
                        <b class="caret"></b>
                      </p>
                    </a>
                    <div class="collapse" id="NYK">
                      <ul class="nav">
                        <li class="nav-item ">
                          <a class="nav-link" href="#">
                            <span class="sidebar-mini"> BE </span>
                            <span class="sidebar-normal"> BERLIAN EKUATOR </span>
                          </a>
                        </li>
                        <li class="nav-item ">
                          <a class="nav-link" href="#">
                            <span class="sidebar-mini"> J </span>
                            <span class="sidebar-normal"> JINGU </span>
                          </a>
                        </li>
                        <li class="nav-item ">
                          <a class="nav-link" href="#">
                            <span class="sidebar-mini"> T </span>
                            <span class="sidebar-normal"> TOWADA </span>
                          </a>
                        </li>
                      </ul>
                    </div>
                  </li>
                  <li class="nav-item ">
                        <a class="nav-link" data-toggle="collapse" href="#NIMIC">
                          <i class="material-icons">image</i>
                          <p> NIMIC
                            <b class="caret"></b>
                          </p>
                        </a>
                        <div class="collapse" id="NIMIC">
                          <ul class="nav">
                            <li class="nav-item ">
                              <a class="nav-link" href="#">
                                <span class="sidebar-mini"> T1 </span>
                                <span class="sidebar-normal"> TAITAR NO.1 </span>
                              </a>
                            </li>
                            <li class="nav-item ">
                              <a class="nav-link" href="#">
                                <span class="sidebar-mini"> T2 </span>
                                <span class="sidebar-normal"> TAITAR NO.2 </span>
                              </a>
                            </li>
                            <li class="nav-item ">
                              <a class="nav-link" href="#">
                                <span class="sidebar-mini"> T3 </span>
                                <span class="sidebar-normal"> TAITAR NO.3 </span>
                              </a>
                            </li>
                          </ul>
                        </div>
                      </li>    
        </ul>
      </div>
    </div>
    <div class="main-panel">
      <!-- Navbar -->
      <nav class="navbar navbar-expand-lg navbar-transparent navbar-absolute fixed-top ">
        <div class="container-fluid">
          <div class="navbar-wrapper">
              <div class="navbar-minimize">
                  <button id="minimizeSidebar" class="btn btn-just-icon btn-white btn-fab btn-round">
                    <i class="material-icons text_align-center visible-on-sidebar-regular">more_vert</i>
                    <i class="material-icons design_bullet-list-67 visible-on-sidebar-mini">view_list</i>
                  </button>
              </div>
            <a class="navbar-brand" href="#">My Fleet</a>
          </div>
          <button class="navbar-toggler" type="button" data-toggle="collapse" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="navbar-toggler-icon icon-bar"></span>
            <span class="navbar-toggler-icon icon-bar"></span>
            <span class="navbar-toggler-icon icon-bar"></span>
          </button>
          <div class="collapse navbar-collapse justify-content-end">
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link" href="#pablo">
                  <i class="material-icons">notifications</i> Notifications
                </a>
              </li>
              <!-- your navbar here -->
            </ul>
          </div>
        </div>
      </nav>
      <!-- End Navbar -->
      <div class="content">
        <div class="container-fluid">
          <!-- your content here -->
          <div class="row">
          <div class="col-md-8">
              <div class="card" id="chart1">
                <div class="card-header card-header-rose card-header-icon">
                  <div class="card-icon">
                    <i class="material-icons">assignment</i>
                  </div>
                  <!-- Selection Category -->
                  <div>
                  <h4 class="card-title"><b>Fleet Valuation Information</b><br>
                    <h5 class="card-title"><b>Select reported year: </b>
                      <select class="opt">
                          <option value="CC">2018</option>
                          <option value="DD">2019</option>
                        </select>
                    </h5>
                  </h4>
                  </div>
                    <svg width="600" height="400"></svg>
                  </div>
                </div>
            <div class="col-md-4">
                <div class="card ">
                  <div class="card-header card-header-text card-header-rose">
                    <div class="card-text">
                    <h4 class="card-title">Notifications</h4>
                    </div>
                  </div>
                  <div class="card-body " id="notification"></div>
                </div>
              </div>
            </div>
      </div>
      </div>
      <footer class="footer">
        <div class="container-fluid">
          <nav class="float-left">
            <ul>
              <li>
                <a href="https://insurwave.com">
                  Team AI Insurwave
                </a>
              </li>
            </ul>
          </nav>
          <div class="copyright float-right">
            &copy;
            <script>
              document.write(new Date().getFullYear())
            </script>, made by
            <a href="https://insurwave.com" target="_blank">Team AI Insurwave</a>
          </div>
          <!-- your footer here -->
        </div>
      </footer>
    </div>
  </div>
  <!--   Core JS Files   -->
  <script src="assets/js/core/jquery.min.js"></script>
  <script src="assets/js/core/popper.min.js"></script>
  <script src="assets/js/core/bootstrap-material-design.min.js"></script>
  <script src="assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  <!-- Plugin for the momentJs  -->
  <script src="assets/js/plugins/moment.min.js"></script>
  <!--  Plugin for Sweet Alert -->
  <script src="assets/js/plugins/sweetalert2.js"></script>
  <!-- Forms Validations Plugin -->
  <script src="assets/js/plugins/jquery.validate.min.js"></script>
  <!-- Plugin for the Wizard, full documentation here: https://github.com/VinceG/twitter-bootstrap-wizard -->
  <script src="assets/js/plugins/jquery.bootstrap-wizard.js"></script>
  <!--	Plugin for Select, full documentation here: http://silviomoreto.github.io/bootstrap-select -->
  <script src="assets/js/plugins/bootstrap-selectpicker.js"></script>
  <!--  Plugin for the DateTimePicker, full documentation here: https://eonasdan.github.io/bootstrap-datetimepicker/ -->
  <script src="assets/js/plugins/bootstrap-datetimepicker.min.js"></script>
  <!--  DataTables.net Plugin, full documentation here: https://datatables.net/  -->
  <script src="assets/js/plugins/jquery.dataTables.min.js"></script>
  <!--	Plugin for Tags, full documentation here: https://github.com/bootstrap-tagsinput/bootstrap-tagsinputs  -->
  <script src="assets/js/plugins/bootstrap-tagsinput.js"></script>
  <!-- Plugin for Fileupload, full documentation here: http://www.jasny.net/bootstrap/javascript/#fileinput -->
  <script src="assets/js/plugins/jasny-bootstrap.min.js"></script>
  <!-- Vector Map plugin, full documentation here: http://jvectormap.com/documentation/ -->
  <script src="assets/js/plugins/jquery-jvectormap.js"></script>
  <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
  <script src="assets/js/plugins/nouislider.min.js"></script>
  <!-- Include a polyfill for ES6 Promises (optional) for IE11, UC Browser and Android browser support SweetAlert -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/core-js/2.4.1/core.js"></script>
  <!-- Library for adding dinamically elements -->
  <script src="assets/js/plugins/arrive.min.js"></script>
  <!--  Bing Maps Plugin    -->
  <script type='text/javascript' src='https://www.bing.com/api/maps/mapcontrol?callback=GetMap&setLang=en&setMkt=en-GB&key=AtG0h65a58rN_XG9CBwF21YBrAk82GzkMrzCgf9nlc0KCzdaSY_W4fSOBf3uZA_V' async defer></script>
  <!-- Chartist JS -->
  <script src="assets/js/plugins/chartist.min.js"></script>
  <!--  Notifications Plugin    -->
  <script src="assets/js/plugins/bootstrap-notify.js"></script>
  <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="assets/js/material-dashboard.js?v=2.1.0" type="text/javascript"></script>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.9.1/d3-tip.js"></script>
  
  
</body>

<script>

  var speed = 0;

  d3.csv("https://raw.githubusercontent.com/nataliaokuneva/data_vessel/master/claim.csv").then(function(data) {

      chart(data, "CC")

      d3.selectAll(".opt").on("change", function() {
          speed = 750;
          chart.update(data, this.value)
      })

  });

  function chart(data, input) {

      var z = d3.scaleOrdinal()
          .range(["#99CCFF","#3399FF","#0066CC"]);
      
      // Create a tooltip
      var tip = d3.tip().attr('class', 'd3-tip').direction('e').offset([0,5])
              .html(function(d) {
                  return d.value;
              });

      var svg = d3.select("svg"),
          margin = {top: 35, right: 35, bottom: 35, left: 35},
          width = +svg.attr("width") - margin.left - margin.right,
          height = +svg.attr("height") - margin.top - margin.bottom;

      var keys = data.columns.slice(1, 4);

      var x0 = d3.scaleBand()
          .domain(data.map(d => d.State))
          .range([margin.left, width - margin.right])
          .padding(0.1);

      var x1 = d3.scaleBand()
          .domain(keys)
          .rangeRound([0, x0.bandwidth()]);

      var y = d3.scaleLinear()
          .range([height, margin.top]);

      svg.append("g")
          .attr("class", "x-axis");

      svg.append("g")
        .attr("class", "y-axis");
        

      // Handmade legend
      svg.append("rect").attr("x",width-135).attr("y",height-417).attr("width", 13).attr('height', 13).style("fill", "#99CCFF")
      svg.append("rect").attr("x",width-135).attr("y",height-402).attr("width", 13).attr('height', 13).style("fill", "#3399FF")
      svg.append("rect").attr("x",width-135).attr("y",height-387).attr("width", 13).attr('height', 13).style("fill", "#0066CC")

      svg.append("text").attr("x", width-115).attr("y", height-410).text("Valuation, USD").style("font-size", "15px").attr("alignment-baseline","middle")
      svg.append("text").attr("x", width-115).attr("y", height-394).text("Premium, USD").style("font-size", "15px").attr("alignment-baseline","middle")
      svg.append("text").attr("x", width-115).attr("y", height-378).text("Claim, USD").style("font-size", "15px").attr("alignment-baseline","middle")

      var xAxis = g => g
          .attr("transform", "translate(0," + height + ")")
          .call(d3.axisBottom(x0)
              .tickSizeOuter(0))

      var yAxis = g => g
          .attr("transform", 
              "translate(" + margin.left + ",0)")
          .call(d3.axisLeft(y).ticks(null, "s"))

      svg.call(tip);

      update(data, input);

      function update(data, input) {

          var copy = [];

          keys.forEach(function(t) {
              t = t.slice(0, -2)
              copy.push(t)
          })

          y.domain([0, d3.max(data, function(d) {
              return d3.max(copy, function(key) {
                  return d3.sum([d[key + input]])
              }); 
          })]).nice();

          var barGroups = svg.selectAll(".layer")
              .data(data, d => d.State);

          barGroups.exit().remove();

          barGroups.enter().append("g")
              .classed('layer', true);

          svg.selectAll(".layer").transition().duration(speed)
              .attr("transform", function(d, i) {
                  return "translate(" + x0(d.State) + ",0)";
              });

          var bars = svg.selectAll(".layer").selectAll(".bars")
              .data(function(d) { 
                  return copy.map(function(key) {
                      return {key: key + input, value: d[key + input]}; 
                  }); 
              });

          bars = bars
              .enter()
          .append("rect")
              .attr("class", "bars")
              .attr("x", d => x1(d.key))
              .attr("width", x1.bandwidth())
              .attr("fill", d => z(d.key))
              .merge(bars);

          bars.transition().duration(speed)
              .attr("height", d => height - y(d["value"]))
              .attr("y", d => y(d.value))

          svg.selectAll(".x-axis").transition().duration(speed)
              .call(xAxis);
          
          svg.selectAll(".y-axis").transition().duration(speed)
              .call(yAxis);

          svg.call(zoom);


          function zoom(group) {
          
              var extent = [
                  [margin.left, margin.top], 
                  [width - margin.right, height - margin.top]
              ];
              
              group.call(d3.zoom()
                  .scaleExtent([1, 2])
                  .translateExtent(extent)
                  .extent(extent)
                  .on("zoom", zoomed));
              
              function zoomed() {
          
                  x0.range(
                      [margin.left, width - margin.right]
                      .map(d => d3.event.transform.applyX(d)));
                  x1.rangeRound([0, x0.bandwidth()]);
          
                  group.selectAll(".layer")
                      .attr("transform", function(d) { 
                          return "translate(" + x0(d.State) + ",0)"; 
                      });
                  group.selectAll(".bars")
                      .attr("x", function(d) { 
                          return x1(d.key)
                      })
                      .attr("width", x1.bandwidth());
          
                  group.selectAll(".x-axis")
                      .call(xAxis);
              }
          }

      }

      chart.update = update;   
  };
  
    </script>

</html>
